name: Build MiniWebView DLL

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup MSBuild
        uses: microsoft/setup-msbuild@v1.1

      - name: Build MiniWebView.dll (x86 /MT)
        shell: cmd
        run: |
          echo Building MiniWebView.dll (x86 /MT)
          REM Use Visual Studio Developer Command Prompt environment
          call "C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" x86
          cl /nologo /EHsc /MT /LD MiniWebView.cpp /link /OUT:MiniWebView.dll ole32.lib oleaut32.lib uuid.lib user32.lib gdi32.lib

      - name: Upload DLL artifact
        uses: actions/upload-artifact@v3
        with:
          name: MiniWebView_DLL
          path: MiniWebView.dll
